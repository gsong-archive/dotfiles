name: "sni"
windows:
  - name: client
    root: ~/src/cd-planning-ui/
    layout: even-vertical
    focus: true
    panes:
      - commands:
        - until $(curl --output /dev/null --silent --head --fail http://localhost:8082/planning/1.0/brands); do printf '.'; sleep 1; done
        - cd ~/src/cd-planning-ui/
        - pkill karma
        - nvm use
        - ulimit -n 10200
        - bin/gulp
        focus: true

  - name: servers
    root: ~/
    layout: even-vertical
    panes:
      - commands:
        - cd ~/src/cd-planning-service/
        - ./gradlew clean install
        - ./gradlew --refresh-dependencies runWFTS

      - commands:
        - until $(curl --output /dev/null --silent --head --fail http://localhost:8084/workflow-tracking/v1/status); do printf '.'; sleep 1; done
        - cd ~/src/cd-planning-service/
        - ./gradlew --refresh-dependencies run

      - commands:
        - until $(curl --output /dev/null --silent --head --fail http://localhost:8084/workflow-tracking/v1/status); do printf '.'; sleep 1; done
        - cd ~/src/cd-planning-ui/
        - ./gradlew --refresh-dependencies clean run
