###########
# Aliases #

# Commands
alias diff=colordiff
alias flushdns='sudo dscacheutil -flushcache;sudo killall -HUP mDNSResponder'
alias l='ls $LS_OPTIONS -la'
alias ll='ls $LS_OPTIONS -l'
alias ls='ls $LS_OPTIONS -hFG'
alias lsvirtualenv='lsvirtualenv -b'
alias pdfcombine='"/System/Library/Automator/Combine PDF Pages.action/Contents/Resources/join.py"'
alias pgrep='pgrep -f -l'
alias pkill='pkill -f -l'
alias ql='qlmanage -p'
alias reset-wifi='networksetup -setairportpower en0 off && networksetup -setairportpower en0 on'
alias rm='rm -i'
alias screen='screen -T xterm-color'
alias top='top -s 5 -o cpu -stats pid,user,command,cpu,rsize,vsize,threads,state'
alias vagrant='caffeinate vagrant'

# grep
for PATTERN in "{.git,.hg}" "\*.egg-info"; do
  GREP_OPTIONS="$GREP_OPTIONS --exclude-dir=$PATTERN"
done

for PATTERN in "*.{pyc,swp}" tags; do
  GREP_OPTIONS="$GREP_OPTIONS --exclude=$PATTERN"
done

GREP_OPTIONS="$GREP_OPTIONS -I --color"
alias grep="/usr/bin/env grep $GREP_OPTIONS"


if type mvim &> /dev/null; then
  if [[ "$TERM_PROGRAM" == "Apple_Terminal" ]]; then
    alias vi='open -a MacVim'
  fi
fi

# Development
alias runserver='./manage.py runserver_plus 0.0.0.0:8000 --cert /tmp/cert'
alias profileserver='manage runprofileserver --kcachegrind --prof-path=/Users/george/Scratch/django_profile'

# Functions

## Use Apple's man page viewer if we are on a local console
if [[ "$TERM_PROGRAM" == "Apple_Terminal" ]]; then
  function man {
    open x-man-page://$1
  }
fi

## Get favicon to use as Mail.apps from user image
function npm-exec() {
  $(npm bin)/"$@"
}

function mailfav() {
  EMAIL=$1;
  DOMAIN=${EMAIL#*@}

  mkdir -p ~/Library/Images/People
  wget http://$DOMAIN/favicon.ico -O ~/Library/Images/People/$EMAIL.tiff
}
