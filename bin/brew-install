#!/bin/bash

set -e

# Manually remove the brew cache, since that is the only way to force
# `brew cask install` to grab the latest versions of its recipes.
# https://github.com/phinze/homebrew-cask/issues/309#issuecomment-32470815
rm -rf "$(brew --cache)" && mkdir -p "$(brew --cache)"

brew cleanup --force
brew update
brew upgrade

brew tap | grep -q homebrew/completions || brew tap homebrew/completions
brew tap | grep -q homebrew/dupes || brew tap homebrew/dupes
brew tap | grep -q homebrew/versions || brew tap homebrew/versions
brew tap | grep -q nviennot/tmate || brew tap nviennot/tmate
brew tap | grep -q phinze/cask || brew tap phinze/cask

# Needed for Rails development
brew install apple-gcc42 git postgresql qt

# Better versions of Mac built-ins
brew install bash bash-completion colordiff grep

# More nice-to-haves and various development libraries
brew install ack ctags django-completion dos2unix graphviz iftop imagemagick \
  macvim macvim mercurial mtr multimarkdown node phantomjs python python25 \
  python26 qpdf s3cmd sleepwatcher ssh-copy-id swig terminal-notifier tmate \
  tree wdiff wget

# Color calibration
brew install argyll

# Quick Look plugins
brew install brew-cask
brew cask install --force qlcolorcode qlmarkdown qlprettypatch qlstephen quicklook-csv \
  quicklook-json webp-quicklook
qlmanage -r

brew cask alfred link

brew unlink python
brew link python
