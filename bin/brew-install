#!/bin/bash

set -e

# Manually remove the brew cache, since that is the only way to force
# `brew cask install` to grab the latest versions of its recipes.
# https://github.com/phinze/homebrew-cask/issues/309#issuecomment-32470815
rm -rf "$(brew --cache)" && mkdir -p "$(brew --cache)"

caffeinate brew cleanup --force
caffeinate brew update
caffeinate brew upgrade

caffeinate brew tap | grep -q homebrew/completions || caffeinate brew tap \
  homebrew/completions
caffeinate brew tap | grep -q homebrew/dupes || caffeinate brew tap \
  homebrew/dupes
caffeinate brew tap | grep -q homebrew/versions || caffeinate brew tap \
  homebrew/versions
caffeinate brew tap | grep -q nviennot/tmate || caffeinate brew tap \
  nviennot/tmate
caffeinate brew tap | grep -q phinze/cask || caffeinate brew tap phinze/cask

# Needed for Rails development
caffeinate brew install apple-gcc42 git postgresql qt

# Better versions of Mac built-ins
caffeinate brew install bash bash-completion colordiff grep

# More nice-to-haves and various development libraries
caffeinate brew install ack ctags django-completion dos2unix graphviz iftop \
  imagemagick macvim mercurial mtr multimarkdown node phantomjs python \
  python25 python26 qpdf s3cmd sleepwatcher ssh-copy-id terminal-notifier \
  tmate tree wdiff wget

# Color calibration
caffeinate brew install argyll

# Quick Look plugins
caffeinate brew install brew-cask
caffeinate brew cask install --force qlcolorcode qlmarkdown qlprettypatch \
  qlstephen quicklook-csv quicklook-json webp-quicklook
qlmanage -r

# OS X apps
caffeinate brew cask install --force easyfind f-lux fluid handbrake \
  keyboardcleantool namebench nvalt onyx private-eye vagrant virtualbox vlc

caffeinate brew cask alfred link

caffeinate brew unlink python
caffeinate brew link python
